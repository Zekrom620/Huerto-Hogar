<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HuertoHogar - Cat√°logo de Productos Frescos</title>
    <link rel="stylesheet" href="css/estilo.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>

<body>
    <header>
        <div class="top-bar">
            <div>
                <img src="img/Logo.png" alt="Logo HuertoHogar" width="40">
                <span>HuertoHogar</span>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="productos.html" class="activo">Productos</a>
                <a href="nosotros.html">Nosotros</a>
                <a href="blogs.html">Blog & Tips</a>
                <a href="contacto.html">Contacto</a>
            </nav>
            <div class="acciones">
                <a href="login.html">Iniciar sesi√≥n</a> |
                <a href="registro.html">Registrar usuario</a> |
                <a href="carrito.html" class="carrito">Carrito 0</a>
            </div>
        </div>
    </header>

    <main>
        <h2>Cat√°logo: Productos Frescos del Campo</h2>
        
        <div id="filtros-categoria" style="margin-bottom: 30px; text-align: center; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
            <button class="btn-primary" data-categoria="todos">üß∫ Ver Todo</button>
            <button class="btn-primary" data-categoria="frutas-frescas">üçé Frutas Frescas</button>
            <button class="btn-primary" data-categoria="verduras-organicas">ü•¨ Verduras Org√°nicas</button>
            <button class="btn-primary" data-categoria="productos-organicos">üçØ Otros Org√°nicos</button>
            <button class="btn-primary" data-categoria="lacteos">ü•õ Productos L√°cteos</button>
        </div>

        <section class="catalogo"></section>
    </main>
    
    <footer>
        <p>HuertoHogar ‚Ä¢ Frescura y Calidad Directa del Campo ‚Ä¢ Chile</p>
    </footer>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const botonesFiltro = document.querySelectorAll('#filtros-categoria .btn-primary');
            const catalogoContainer = document.querySelector('.catalogo');
            
            // Funci√≥n mejorada para renderizar productos, usando un argumento de filtro
            // Se asume que formatCLP, PRODUCTOS, y $all est√°n disponibles globalmente en script.js
            function renderProductosConFiltro(categoria = 'todos') {
                if (!catalogoContainer || typeof PRODUCTOS === 'undefined') return;

                const productosFiltrados = PRODUCTOS.filter(p => {
                    return categoria === 'todos' || p.categoria === categoria;
                });

                catalogoContainer.innerHTML = '';
                
                if (productosFiltrados.length === 0) {
                     catalogoContainer.innerHTML = '<p style="text-align: center;">A√∫n no tenemos productos en esta categor√≠a.</p>';
                     return;
                }

                productosFiltrados.forEach(p => {
                    const div = document.createElement('div');
                    div.className = 'producto-item card';
                    div.innerHTML = `
                        <img src="${p.imagen}" alt="${p.nombre}" loading="lazy">
                        <p class="prod-nombre">${p.nombre}</p>
                        <p class="badge">${p.origen || 'Origen Local'}</p> 
                        <p class="prod-precio">${formatCLP(p.precio)}</p>
                        <div class="prod-buttons">
                            <button class="btn-agregar" data-id="${p.id}">A√±adir al carrito</button>
                            <button class="btn-ver-detalle" data-id="${p.id}">Ver Producto</button>
                        </div>
                    `;
                    catalogoContainer.appendChild(div);
                });
            }

            // Manejador de eventos para los botones de filtro
            botonesFiltro.forEach(boton => {
                boton.addEventListener('click', () => {
                    const categoria = boton.dataset.categoria;
                    renderProductosConFiltro(categoria);
                    
                    // Resaltar el bot√≥n activo
                    botonesFiltro.forEach(b => b.classList.remove('activo-filtro'));
                    boton.classList.add('activo-filtro');
                });
            });
            
            // Estilo b√°sico para el filtro activo (si no est√° en estilo.css)
            const style = document.createElement('style');
            style.textContent = '.activo-filtro { background-color: var(--color-marron-titulo, #8B4513) !important; color: white !important; }';
            document.head.appendChild(style);

            // Inicializaci√≥n: Mostrar todos los productos al cargar la p√°gina y activar el bot√≥n
            const botonTodos = document.querySelector('#filtros-categoria button[data-categoria="todos"]');
            if (botonTodos) {
                renderProductosConFiltro('todos'); 
                botonTodos.classList.add('activo-filtro');
            }
        });
    </script>
</body>

</html>